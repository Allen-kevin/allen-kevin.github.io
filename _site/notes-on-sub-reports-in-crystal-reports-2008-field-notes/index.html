<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Notes on Sub-Reports in Crystal Reports 2008 [Field Notes] &#8211; SeanKilleen.com</title>
<meta name="description" content="For starters, in CR 2008, you can’t create two separate groups of data in one report (for example, all labor for a work order and then all materials for a work order).

">
<meta name="keywords" content="">



<!-- Twitter Cards -->
<meta name="twitter:title" content="Notes on Sub-Reports in Crystal Reports 2008 [Field Notes]">
<meta name="twitter:description" content="For starters, in CR 2008, you can’t create two separate groups of data in one report (for example, all labor for a work order and then all materials for a work order).

">
<meta name="twitter:site" content="@sjkilleen">
<meta name="twitter:creator" content="@sjkilleen">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://localhost:4000/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Notes on Sub-Reports in Crystal Reports 2008 [Field Notes]">
<meta property="og:description" content="For starters, in CR 2008, you can’t create two separate groups of data in one report (for example, all labor for a work order and then all materials for a work order).

">
<meta property="og:url" content="http://localhost:4000/notes-on-sub-reports-in-crystal-reports-2008-field-notes/">
<meta property="og:site_name" content="SeanKilleen.com">





<link rel="canonical" href="http://localhost:4000/notes-on-sub-reports-in-crystal-reports-2008-field-notes/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="SeanKilleen.com Feed">
<link rel="author" href="http://plus.google.com/+SeanKilleen?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://localhost:4000/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://localhost:4000/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://localhost:4000">SeanKilleen.com</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
					    
					        
					    
					    <li><a href="http://localhost:4000/about/" >About</a></li>
					  
					    
					        
					    
					    <li><a href="http://localhost:4000/posts/" >Sample Posts</a></li>
					  
					    
					        
					    
					    <li><a href="http://localhost:4000/theme-setup/" >Theme Setup</a></li>
					  
					    
					        
					        
					    <li><a href="http://mademistakes.com" target="_blank">Made Mistakes</a></li>
					  
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    



	<img src="http://localhost:4000/images/bio-photo.jpg" class="bio-photo" alt="Sean Killeen bio photo">

<h3>Sean Killeen</h3>
<p>Just a guy trying to get better at writing bios.</p>
<a href="mailto:SeanKilleen@gmail.com" class="author-social" target="_blank"><i class="fa fa-envelope-square"></i> Email</a>
<a href="http://twitter.com/sjkilleen" class="author-social" target="_blank"><i class="fa fa-twitter-square"></i> Twitter</a>
<a href="http://facebook.com/SeanKilleen" class="author-social" target="_blank"><i class="fa fa-facebook-square"></i> Facebook</a>
<a href="http://plus.google.com/+SeanKilleen" class="author-social" target="_blank"><i class="fa fa-google-plus-square"></i> Google+</a>
<a href="http://linkedin.com/in/SeanKilleen" class="author-social" target="_blank"><i class="fa fa-linkedin-square"></i> LinkedIn</a>
<a href="http://instagram.com/skilleen" class="author-social" target="_blank"><i class="fa fa-instagram"></i> Instagram</a>

<a href="http://github.com/SeanKilleen" class="author-social" target="_blank"><i class="fa fa-github"></i> Github</a>
<a href="http://stackoverflow.com/users/316847/seankilleen" class="author-social" target="_blank"><i class="fa fa-stack-overflow"></i> Stackoverflow</a>



<a href="http://foursquare.com/SeanKilleen" class="author-social" target="_blank"><i class="fa fa-foursquare"></i> Foursquare</a>


  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="http://localhost:4000/notes-on-sub-reports-in-crystal-reports-2008-field-notes/" rel="bookmark" title="Notes on Sub-Reports in Crystal Reports 2008 [Field Notes]">Notes on Sub-Reports in Crystal Reports 2008 [Field Notes]</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>For starters, in CR 2008, you can’t create two separate groups of data in one report (for example, all labor for a work order and then all materials for a work order).</p>

<p>To do this, you need to create a sub-report, format it, and pass any values back up to the main report using shared variables.</p>

<p><a href="http://www.codeguru.com/forum/showpost.php?p=1701455&amp;postcount=2">This forum post</a> that I found has a great quick run-down on how to accomplish shared variables from sub-reports to main reports. It was very helpful in understanding the wonky Crystal syntax behind what should be a simple thing.</p>

<p>The post is excerpted (though poorly formatted) below in case the originating site ever goes away. <strong>NOTE:</strong> None of the content below is mine; it is a reproduction because the information was too valuable to lose.</p>

<hr />
<blockquote>
  <p>Shared variables, introduced since Crystal Reports version 7, make it easier to pass values from a subreport to the main report.</p>
</blockquote>

<blockquote>
  <p>Using shared variables requires two formulas:<br />one to store the value in a shared variable, the other to retrieve the<br />value from the shared variable.</p>
</blockquote>

<blockquote>
  <p>The most important thing to remember when using shared variables is that Crystal Reports must first evaluate the formula where the value is stored before evaluating the formula that retrieves the shared variable. For example if you want to pass a grand total from the subreport to do a calculation in the main report, follow these steps:</p>
</blockquote>

<ul>
  <li>In the subreport, create a formula similar to the one below:</li>
</ul>

<p>```
// SubFormula
//Stores the grand total of the {Orders.Order Amount} field
//in a currency variable called ‘myTotal’</p>

<p>WhilePrintingRecords;
Shared CurrencyVar myTotal := Sum ({Orders.Order Amount})
```</p>

<blockquote>
  <ul>
    <li>
      <p>Place this formula in your subreport.</p>
    </li>
    <li>
      <p>In the main report, create a formula that declares the same variable name:</p>
    </li>
  </ul>
</blockquote>

<p>```
//@MainFormula
//Returns the value that was stored in the shared currency variable called
//myTotal in the subreport</p>

<p>WhilePrintingRecords;
Shared CurrencyVar myTotal;</p>

<p>myTotal
```
&gt; * Place <code>@MainFormula</code> in a main report section that is beneath the section<br />containing the subreport. For the shared variable to return the correct value in the main report, you must place <code>@MainFormula</code> in a main report section that is beneath the section containing the subreport. This ensures Crystal Reports evaluates the <code>@SubFormula</code> before <code>@MainFormula</code>.</p>

<blockquote>
  <p>One way to do this is to insert a section below the section containing the subreport, and place <code>@MainFormula</code> in this new sub-section:</p>
</blockquote>

<blockquote>
  <ul>
    <li>On the <code>Format</code> menu, click <code>Section</code>.</li>
    <li>On the <code>Sections</code> list, click the section containing the subreport.</li>
    <li>Click <code>Insert</code> (at top of dialog box). This inserts an additional subsection.</li>
    <li>Click <code>OK</code> to return to the report, and insert <code>@MainFormula</code> into this new subsection.</li>
  </ul>
</blockquote>

<blockquote>
  <p>The next time you preview the report, <code>@MainFormula</code> displays the value from the subreport. In this particular example, that value was the grand total of the <code>{Orders.Order Amount}</code> field.</p>
</blockquote>

<blockquote>
  <ul>
    <li>Once you have verified that <code>@MainFormula</code> is returning the correct value from the subreport, you can include this formula in other main report formulas, such as:</li>
  </ul>
</blockquote>

<p><code>
//@NewFormula
//includes data from subreport
{@MainFormula}+ Sum ({Customer.Last Year's Sales})
</code>
&gt; Place this formula in the same section as <code>@MainFormula</code>, or in a section further down on the report.</p>

<h3 id="references">References</h3>
<ul>
  <li><a href="http://www.codeguru.com/forum/showthread.php?t=449494">How to Get Formula Field Value From Subreport to Main Report</a> [<a href="http://www.codeguru.com/">CodeGuru</a>]</li>
</ul>

      <hr />
      <footer role="contentinfo">
        <div class="article-author-bottom">
          



	<img src="http://localhost:4000/images/bio-photo.jpg" class="bio-photo" alt="Sean Killeen bio photo">

<h3>Sean Killeen</h3>
<p>Just a guy trying to get better at writing bios.</p>
<a href="mailto:SeanKilleen@gmail.com" class="author-social" target="_blank"><i class="fa fa-envelope-square"></i> Email</a>
<a href="http://twitter.com/sjkilleen" class="author-social" target="_blank"><i class="fa fa-twitter-square"></i> Twitter</a>
<a href="http://facebook.com/SeanKilleen" class="author-social" target="_blank"><i class="fa fa-facebook-square"></i> Facebook</a>
<a href="http://plus.google.com/+SeanKilleen" class="author-social" target="_blank"><i class="fa fa-google-plus-square"></i> Google+</a>
<a href="http://linkedin.com/in/SeanKilleen" class="author-social" target="_blank"><i class="fa fa-linkedin-square"></i> LinkedIn</a>
<a href="http://instagram.com/skilleen" class="author-social" target="_blank"><i class="fa fa-instagram"></i> Instagram</a>

<a href="http://github.com/SeanKilleen" class="author-social" target="_blank"><i class="fa fa-github"></i> Github</a>
<a href="http://stackoverflow.com/users/316847/seankilleen" class="author-social" target="_blank"><i class="fa fa-stack-overflow"></i> Stackoverflow</a>



<a href="http://foursquare.com/SeanKilleen" class="author-social" target="_blank"><i class="fa fa-foursquare"></i> Foursquare</a>


        </div>
        <p class="byline"><strong>Notes on Sub-Reports in Crystal Reports 2008 [Field Notes]</strong> was published on <time datetime="2011-11-28T11:15:00-05:00">November 28, 2011</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://localhost:4000/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="http://localhost:4000/how-to-drag-and-drop-files-to-an-elevated-program-field-notes/" title="How to: Drag and Drop Files to an Elevated Program [Field Notes]">How to: Drag and Drop Files to an Elevated Program [Field Notes]</a></li>
    
      <li><a href="http://localhost:4000/quick-tip-file-hashes-with-powershell-community-extensions/" title="Quick Tip: File Hashes with PowerShell Community Extensions">Quick Tip: File Hashes with PowerShell Community Extensions</a></li>
    
      <li><a href="http://localhost:4000/web-site-fail-of-the-day-intel-rst-community-forum/" title="Web site fail of the day: Intel RST Community Forum">Web site fail of the day: Intel RST Community Forum</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  <footer>
    

<span>&copy; 2014 Sean Killeen. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>

  
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'seankilleencom'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

	        

</body>
</html>