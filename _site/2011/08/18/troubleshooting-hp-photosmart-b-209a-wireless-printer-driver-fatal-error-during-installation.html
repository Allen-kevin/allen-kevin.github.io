<p>I recently re-installed Windows 7 x64 on my laptop due to purchasing an SSD. I expected fantastic speed &amp; performance, more productivity, etc.</p>

<p>What I didn’t expect was for HP Driver setup to make me want to tear my hair out.</p>

<p>What follows is a brief and too-technical tale of how I vanquished the foe, for my own reference. If you’re less-than-technical or think they could help you, just ask me for details or screenshots in the comments and I’ll be happy to provide them.</p>

<h3 id="the-problem">The Problem</h3>
<p>HP Driver setup for a wireless printer already configured on your network yields a generic “Fatal Error During Installation” message. Though my Antivirus/Firewall were disabled and I ran the downloaded installer as Administrator, I still received the message whenever I ran the setup program.</p>

<h3 id="applies-to">Applies To</h3>
<p>I have not tested this in any other environments, so I’m assuming it applies to:</p>

<ul>
  <li>HP PhotoSmart B-209a printers that have already been configued on the wireless network</li>
  <li>Win 7 Professional 64-bit</li>
</ul>

<h3 id="the-solution-steps">The Solution Steps</h3>
<ul>
  <li><strong>Disable Your Antivirus Applications (Firewalls are OK).</strong> Though not the root cause of the issue, Antivirus programs can still muck with the process. Best to temporarily disable. Firewalls on the other hand, you would like to have running so that you can ensure you allow the network connections necessary for the device.</li>
  <li><strong>Take ownership of your local temp directory.</strong> I did this by running the command: 
&gt;takeown /f C:\Users\Username\AppData\Local\Temp /r /d y</li>
</ul>

<p>where <code>Username</code> is your own username.</p>

<ul>
  <li><strong>Remove all restrictive attributes from the Temp directory.</strong> This can be done by running:</li>
</ul>

<blockquote>
  <p>attrib -R -A -S -H C:\Users\Username\AppData\Local\Temp /S /D</p>
</blockquote>

<p>where <code>Username</code> is your own username.</p>

<ul>
  <li><strong>Find where your installation is located in the Temp directory</strong>. For me, it was <code>C:\Users\Username\AppData\Local\Temp\7zS08A6"</code> where <code>Username</code> is your username. The exact folder may be different but I’m hoping they kept it the same.</li>
  <li><strong>Run the actual setup program as Administrator.</strong> Within the installation directory you found in the last step, right-click on <code>setup.exe</code> and select <code>Run as Administrator</code></li>
</ul>

<p>With those steps (and a little bit of luck and/or voodoo magic) the install should complete successfully.</p>

<p>Hope this helps someone! If you have any questions or would like more detail, feel free to ask in the comments.</p>

<p>Happy Troubleshooting!</p>
